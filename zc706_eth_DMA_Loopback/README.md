

# ZYNQ-7000 (ZC706) 数字化下变频 (DDC) 混频实验

本项目基于 Xilinx ZC706 开发板，演示了从硬件信号生成、数据拼接、DMA 传输到上位机实时可视化的全链路开发过程。核心内容为在 FPGA 内部实现两个不同频率正交信号的**硬件级乘法混频**。

## 1. 项目背景与分支

* **Git 分支**: `dma_hunpin`
* **实验目标**: 在 PL 端利用乘法器实现 5MHz 与 4MHz 信号混频，并通过 100MHz 采样率实时回传波形进行分析。

## 2. 系统架构

### 硬件逻辑 (PL 端)

* **信号源**: 两个 **DDS Compiler** 分别产生 5MHz (DDS0) 和 4MHz (DDS1) 的正交 I/Q 信号。
* **位剥离**: 自定义 `iq_split` 模块，从 DDS 的 16 位输出中提取 [15:8] 位（Sine 分量）送入乘法器。
* **混频器**: **Multiplier (Mult_Gen)** IP 核执行  有符号补码乘法，输出 16 位混频结果 。
* **数据拼接 (`tlast_gen`)**:
* **s0_axis (低16位)**: 接入 DDS0 原始 I/Q 信号。
* **s1_axis (高16位)**: 接入 16 位混频结果信号。
* **握手逻辑**: 确保 `s0_axis_tvalid` 与 `s1_axis_tvalid` 同时拉高时进行同步采样，并产生 `TLAST` 信号触发 DMA 传输。



### 嵌入式逻辑 (PS 端)

* **FreeRTOS + lwIP**: 建立 UDP 服务端（端口 5001），支持上位机指令交互。
* **DMA 传输**: 驱动 AXI DMA 将 DDR 中的数据块（单次 8192 字节）通过以太网发送至 PC。

## 3. 混频实验原理

利用积化和差公式：


* **差频 (Difference Frequency)**: 1MHz，表现为波形的低频包络线。
* **和频 (Sum Frequency)**: 9MHz，表现为叠加在包络线上的高频抖动分量。

## 4. 上位机软件 (Python)

基于 **PySide6** 和 **pyqtgraph** 开发的高速示波器：

* **数据解析**: 自动将 32 位原始数据拆分为低 16 位（参考信号）与高 16 位（16位有符号补码解析后的混频信号）。
* **核心功能**:
* **李萨如图形 (XY Mode)**: 验证 IQ 正交性，呈现完美圆形。
* **实时波形显示**: 100MHz 采样率下的抗锯齿平滑绘图。
* **硬件状态监测**: 实时显示 SoC 温度（约 37.7°C）和核心电压（1.00V）。



## 5. 快速开始

1. **硬件准备**: 将 Bitstream 文件加载至 ZC706 开发板。
2. **网络配置**: 确保 PC 与板卡 IP 处于同一网段（板卡默认 IP: `192.168.0.20`）。
3. **运行程序**: 执行 `python dma_udp.py` 启动上位机。
4. **交互控制**: 点击界面 **"开启混频"** 按钮（发送指令 '7'），即可观察 DDC 混频实验结果。

